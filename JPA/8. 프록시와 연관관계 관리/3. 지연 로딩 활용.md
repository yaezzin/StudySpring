## 지연 로딩 활용

<img width="306" alt="스크린샷 2022-06-24 오전 4 13 40" src="https://user-images.githubusercontent.com/97823928/175379245-af53d95e-7eab-40d9-ad87-aa21528c4f51.png">

#### 분석

1. 회원은 팀 하나에만 속할 수 있다 (N:1)
2. 회원은 여러 주문 내역을 가진다 (1:N)
3. 주문내역은 상품 정보를 가진다(N:1)

#### 결론
* Member와 연관된 Team 객체는 자주 사용되었다 👉 즉시 로딩으로 설정
* Member와 연관된 Order는 가끔 사용되었다 👉 지연 로딩으로 설정
* Order과 연관된 Product는 자주 함께 사용되었다 👉 즉시 로딩으로 설정

#### 코드

<img width="385" alt="스크린샷 2022-06-24 오전 4 18 44" src="https://user-images.githubusercontent.com/97823928/175380064-38470552-ccfa-4df4-8f42-6b1d14f6fbec.png">

```java
@Entity
public class Member {
    @Id
    private String id;
    private String username;
    private Integer age;
    
    @ManyToOne(fetch = FetchType.EAGER)
    private Team team;
    
    @OneToMany(mappedBy = "member", fetch = fetchType.LAZY)
    private List<Order> orders;

}
```
#### 회원 조회 시 실행된 SQL
* 회원과 팀은 즉시로딩으로 설정했으므로 조인 쿼리를 만들어 회원과 팀을 한 번에 조회함
* 회원과 주문내역은 지연로딩으로 설정했으므로 결과를 프록시로 조회함 ➡ 따라서 SQL에 나타나지 않음
* 회원을 조회한 후에 member.getTeam()을 호출하면 이미 로딩된 팀 엔티티를 반환
